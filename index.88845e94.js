const t=new class{constructor(t){this.initialState=t,this.initialStateRestart=t?t.map(t=>t.map(t=>t)):[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.state=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.isMerged=[[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1]]}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<this.state.length;e++)for(let s=1;s<this.state[e].length;s++)if(0!==this.state[e][s]){let i=s;for(;i>0&&(0===this.state[e][i-1]||this.state[e][i-1]===this.state[e][i]);)if(0===this.state[e][i-1])this.state[e][i-1]=this.state[e][i],this.state[e][i]=0,t=!0,i--;else if(this.state[e][i-1]!==this.state[e][i]||this.isMerged[e][i-1])break;else this.state[e][i-1]*=2,this.state[e][i]=0,this.score+=this.state[e][i-1],this.isMerged[e][i-1]=!0,t=!0}t&&(this.isMerged.forEach(t=>t.fill(!1)),this.generateNewTiles())}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<this.state.length;e++)for(let s=this.state[e].length-2;s>=0;s--)if(0!==this.state[e][s]){let i=s;for(;i<this.state[e].length-1&&(0===this.state[e][i+1]||this.state[e][i+1]===this.state[e][i]);)if(0===this.state[e][i+1])this.state[e][i+1]=this.state[e][i],this.state[e][i]=0,t=!0,i++;else if(this.state[e][i+1]!==this.state[e][i]||this.isMerged[e][i+1])break;else this.state[e][i+1]*=2,this.score+=this.state[e][i+1],this.state[e][i]=0,t=!0,this.isMerged[e][i+1]=!0}t&&(this.isMerged.forEach(t=>t.fill(!1)),this.generateNewTiles())}moveUp(){if("playing"!==this.status)return;let t=!1;for(let e=1;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)if(0!==this.state[e][s]){let i=e;for(;i>0&&(0===this.state[i-1][s]||this.state[i-1][s]===this.state[i][s]);)if(0===this.state[i-1][s])this.state[i-1][s]=this.state[i][s],this.state[i][s]=0,t=!0,i--;else if(this.state[i-1][s]!==this.state[i][s]||this.isMerged[i-1][s])break;else this.state[i-1][s]*=2,this.score+=this.state[i-1][s],this.state[i][s]=0,t=!0,this.isMerged[i-1][s]=!0}t&&(this.isMerged.forEach(t=>t.fill(!1)),this.generateNewTiles())}moveDown(){if("playing"!==this.status)return;let t=!1;for(let e=this.state.length-2;e>=0;e--)for(let s=0;s<this.state[e].length;s++)if(0!==this.state[e][s]){let i=e;for(;i<this.state.length-1&&(0===this.state[i+1][s]||this.state[i+1][s]===this.state[i][s]);)if(0===this.state[i+1][s])this.state[i+1][s]=this.state[i][s],this.state[i][s]=0,t=!0,i++;else if(this.state[i+1][s]!==this.state[i][s]||this.isMerged[i+1][s])break;else this.state[i+1][s]*=2,this.score+=this.state[i+1][s],this.state[i][s]=0,t=!0,this.isMerged[i+1][s]=!0}t&&(this.isMerged.forEach(t=>t.fill(!1)),this.generateNewTiles())}getScore(){return this.score}getState(){return this.getStatus(),this.state}getStatus(){return this.state.some(t=>t.includes(2048))&&(this.status="win"),this.canMove()||(this.status="lose"),this.status}start(){this.status="playing",this.generateNewTiles(),this.generateNewTiles()}restart(){this.score=0,this.status="idle",this.state=this.initialStateRestart.map(t=>[...t])}generateNewTiles(){if("win"===this.status||"lose"===this.status)return;let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({row:e,col:s});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:s,col:i}=t[e];this.state[s][i]=.9>Math.random()?2:4}}canMove(){for(let t=0;t<this.state.length;t++)for(let e=0;e<this.state[t].length;e++)if(0===this.state[t][e]||e<this.state[t].length-1&&this.state[t][e]===this.state[t][e+1]||t<this.state.length-1&&this.state[t][e]===this.state[t+1][e])return!0;return!1}};function e(){document.querySelector(".game-score").textContent=t.getScore();let e=t.getState(),s=document.querySelectorAll(".field-cell"),i=0;for(let t=0;t<e.length;t++)for(let a=0;a<e[t].length;a++)s[i].textContent=0!==e[t][a]?e[t][a]:"",s[i].className="field-cell",0!==e[t][a]&&s[i].classList.add(`field-cell--${e[t][a]}`),i++;let a=t.getStatus(),h=document.querySelector(".message-start"),r=document.querySelector(".message-win"),l=document.querySelector(".message-lose");"playing"===a?h.classList.add("hidden"):"win"===a?r.classList.remove("hidden"):"lose"===a?l.classList.remove("hidden"):(h.classList.remove("hidden"),r.classList.add("hidden"),l.classList.add("hidden"))}document.addEventListener("DOMContentLoaded",function(){let s=document.querySelector(".start");s.addEventListener("click",()=>{s.classList.contains("start")?(t.start(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"):(t.restart(),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start"),e()}),document.addEventListener("keydown",s=>{if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(s.key)&&s.preventDefault(),"playing"===t.getStatus()){switch(s.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}e(),t.getStatus()}})});
//# sourceMappingURL=index.88845e94.js.map
